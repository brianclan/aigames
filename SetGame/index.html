<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Set Card Game</title>
    <!-- Google AdSense 代码 -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3424102604992913"
      crossorigin="anonymous"
    ></script>
    <style>
      /* 插屏广告样式 */
      .interstitial-ad-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        z-index: 5000;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        display: none;
      }

      .interstitial-ad-container {
        background-color: #fff;
        padding: 10px;
        border-radius: 10px;
        width: 320px;
        height: 280px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
      }

      .countdown-timer {
        position: absolute;
        top: -40px;
        left: 0;
        width: 100%;
        text-align: center;
        color: white;
        font-size: 18px;
        font-weight: bold;
      }
    </style>
    <script type="module" crossorigin>(function(){const b=document.createElement("link").relList;if(b&&b.supports&&b.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))B(r);new MutationObserver(r=>{for(const d of r)if(d.type==="childList")for(const L of d.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&B(L)}).observe(document,{childList:!0,subtree:!0});function $(r){const d={};return r.integrity&&(d.integrity=r.integrity),r.referrerPolicy&&(d.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?d.credentials="include":r.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function B(r){if(r.ep)return;r.ep=!0;const d=$(r);fetch(r.href,d)}})();document.addEventListener("DOMContentLoaded",()=>{const e={deck:[],cardsInPlay:[],selectedCards:[],setsFound:0,gameOver:!1,introShown:!1,gameStarted:!1,hintDisabled:!1},b=["red","green","purple"],$=["oval","triangle","rectangle"],B=[1,2,3],r=["solid","striped","open"],d=document.getElementById("game-board"),L=document.getElementById("score"),j=document.getElementById("remaining"),p=document.getElementById("deal-cards"),S=document.getElementById("find-set"),R=document.getElementById("restart"),U=document.getElementById("show-help"),c=document.getElementById("intro-overlay"),W=document.getElementById("start-game"),Y=document.getElementById("dont-show-again"),V=document.getElementById("help-button"),k=document.getElementById("interstitial-ad-overlay"),O=document.getElementById("countdown-timer"),N=document.getElementById("close-ad");let f=null,h=10,i=null;D(),p.addEventListener("click",()=>y(()=>z())),S.addEventListener("click",()=>y(()=>Z())),R.addEventListener("click",()=>y(()=>F())),U.addEventListener("click",()=>y(()=>P())),W.addEventListener("click",q),V.addEventListener("click",P);function y(s){if(k.style.display==="flex"){console.log("广告已经在显示中，忽略新的请求");return}i=s,h=10,O.textContent=`广告将在 ${h} 秒后关闭`,k.style.display="flex";try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(l){console.error("插屏广告加载失败:",l)}f=setInterval(()=>{h--,O.textContent=`广告将在 ${h} 秒后关闭`,h<=0&&(clearInterval(f),A(!1))},1e3)}function A(s=!1){f&&(clearInterval(f),f=null),k.style.display="none",s&&h>0?e.hintDisabled=!0:(e.hintDisabled=!1,S.classList.remove("disabled")),i&&(i(),i=null)}N.addEventListener("click",()=>{A(!0)});function D(){localStorage.getItem("set_game_played")?(q(!0),v()):(v(),P())}function P(){c.classList.remove("hidden"),e.introShown=!0}function q(s){Y.checked&&localStorage.setItem("set_game_played","true"),e.cardsInPlay.length>0&&u(),s?(c.classList.add("hidden"),e.gameStarted||(e.cardsInPlay.length===0?v():(u(),E()))):(c.style.opacity="1",c.style.transition="opacity 0.5s ease",setTimeout(()=>{c.style.opacity="0",setTimeout(()=>{c.classList.add("hidden"),c.style.opacity="",c.style.transition="",e.cardsInPlay.length===0?v():(u(),E())},500)},10)),e.introShown=!0}function v(){e.gameOver=!1,e.cardsInPlay=[],M(),x(),K(),d.children.length===0&&e.cardsInPlay.length>0&&(console.log("Forcing re-render of cards"),u()),E(),e.gameStarted=!0}function M(){e.deck=[];for(const s of b)for(const l of $)for(const t of B)for(const n of r)e.deck.push({color:s,shape:l,number:t,shading:n})}function x(){for(let s=e.deck.length-1;s>0;s--){const l=Math.floor(Math.random()*(s+1));[e.deck[s],e.deck[l]]=[e.deck[l],e.deck[s]]}}function K(){e.cardsInPlay=[];for(let s=0;s<12;s++)e.deck.length>0&&e.cardsInPlay.push(e.deck.pop());u()}function z(){if(e.gameOver)return;if(H()){T("There is still a set on the board. Find it first!"),_();return}const s=[];for(let l=0;l<3;l++)if(e.deck.length>0){const t=e.deck.pop();e.cardsInPlay.push(t),s.push(e.cardsInPlay.length-1)}u(),s.length>0&&setTimeout(()=>{s.forEach(l=>{const t=document.querySelector(`.card[data-index="${l}"]`);t&&(t.classList.add("new-card"),setTimeout(()=>t.classList.remove("new-card"),1e3))})},100),E()}function u(){d.innerHTML="",e.cardsInPlay.forEach((s,l)=>{const t=document.createElement("div");t.className="card",t.dataset.index=l,e.selectedCards.includes(l)&&t.classList.add("selected");const a=J(s);t.appendChild(a),t.addEventListener("click",()=>m(l)),d.appendChild(t)}),d.offsetHeight}function J(s){const l=document.createElement("div");l.className="card-content";for(let t=0;t<s.number;t++){const n=document.createElement("div");n.className=`symbol ${s.shape} ${s.shading}`,n.style.color=s.color;let a="";s.shape==="triangle"?(n.style.color=s.color,n.style.opacity="",n.style.background="",n.style.borderBottomColor=""):s.shape==="rectangle"?s.shading==="open"?(n.style.background="transparent",n.style.border=`2px solid ${s.color}`):s.shading==="striped"?(n.style.background=`repeating-linear-gradient(45deg, ${s.color}, ${s.color} 3px, transparent 3px, transparent 6px)`,n.style.border=`1px solid ${s.color}`):n.style.background=s.color:s.shape==="oval"&&(s.shading==="open"?(n.style.background="transparent",n.style.border=`2px solid ${s.color}`):s.shading==="striped"?(n.style.background=`repeating-linear-gradient(45deg, ${s.color}, ${s.color} 3px, transparent 3px, transparent 6px)`,n.style.border=`1px solid ${s.color}`):n.style.background=s.color),n.textContent=a,s.shape==="triangle"||(s.shape==="rectangle"?(n.style.width="60%",n.style.height=s.number>2?"20px":"25px"):s.shape==="oval"&&(n.style.width="60%",n.style.height=s.number>2?"20px":"25px",n.style.borderRadius="50%"));const o=document.createElement("div");o.className=`symbol-wrapper ${s.shape}-wrapper`,o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.padding="5px",o.style.width="100%",o.style.height=(s.number>2,"33%"),o.appendChild(n),l.appendChild(o)}return l}function m(s){if(e.gameOver)return;const l=document.querySelector(`.card[data-index="${s}"]`),t=e.selectedCards.indexOf(s);t!==-1?(e.selectedCards.splice(t,1),l.classList.remove("selected")):(e.selectedCards.push(s),l.classList.add("selected"),e.selectedCards.length===3&&Q())}function Q(){const s=e.selectedCards.map(t=>e.cardsInPlay[t]),l=e.selectedCards.map(t=>document.querySelector(`.card[data-index="${t}"]`));G(s)?(l.forEach(t=>{t.classList.add("correct-set")}),setTimeout(()=>{X()},800)):(l.forEach(t=>{t.classList.add("incorrect-set")}),setTimeout(()=>{l.forEach(t=>{t.classList.remove("incorrect-set"),t.classList.remove("selected")}),e.selectedCards=[]},1e3))}function G(s){const l=t=>{const n=s.map(a=>a[t]);return n[0]===n[1]&&n[1]===n[2]||n[0]!==n[1]&&n[1]!==n[2]&&n[0]!==n[2]};return l("color")&&l("shape")&&l("number")&&l("shading")}function X(){e.setsFound++;const s=[...e.selectedCards].sort((l,t)=>t-l);for(const l of s)e.deck.length>0?e.cardsInPlay[l]=e.deck.pop():e.cardsInPlay.splice(l,1);e.selectedCards=[],u(),E(),T(`Set found! You've found ${e.setsFound} sets so far.`,"success"),e.deck.length===0&&!H()&&(e.gameOver=!0,setTimeout(()=>{w()},500))}function E(){L.textContent=e.setsFound,j.textContent=e.deck.length,p.disabled=e.deck.length===0,e.deck.length===0?p.classList.add("disabled"):p.classList.remove("disabled")}function Z(){if(e.gameOver)return;const s=C();s?(e.selectedCards=s,u(),s.forEach(l=>{document.querySelector(`.card[data-index="${l}"]`).classList.add("hint-pulse")}),setTimeout(()=>{s.forEach(l=>{document.querySelector(`.card[data-index="${l}"]`).classList.remove("hint-pulse")}),e.selectedCards=[],u()},2e3)):T("没有找到Set，请尝试添加更多卡牌","info")}function C(){const s=e.cardsInPlay.length;for(let l=0;l<s-2;l++)for(let t=l+1;t<s-1;t++)for(let n=t+1;n<s;n++){const a=[e.cardsInPlay[l],e.cardsInPlay[t],e.cardsInPlay[n]];if(G(a))return[l,t,n]}return null}function H(){return C()!==null}function F(){e.deck=[],e.cardsInPlay=[],e.selectedCards=[],e.setsFound=0,e.gameOver=!1,d.innerHTML="",d.classList.add("restart-animation"),setTimeout(()=>{d.classList.remove("restart-animation"),v()},500)}function T(s,l="warning"){const t=document.querySelector(".notification");t&&t.remove();const n=document.createElement("div");n.className=`notification ${l}`,n.textContent=s,document.body.appendChild(n),setTimeout(()=>n.classList.add("show"),10),setTimeout(()=>{n.classList.remove("show"),setTimeout(()=>n.remove(),300)},3e3)}function _(){d.classList.add("highlight"),setTimeout(()=>{d.classList.remove("highlight")},1e3)}function w(){const s=document.createElement("div");s.className="game-over-modal";const l=document.createElement("div");l.className="modal-content";const t=document.createElement("h2");t.textContent="Game Over!";const n=document.createElement("p");n.textContent=`Congratulations! You found ${e.setsFound} sets.`;const a=document.createElement("button");a.textContent="Play Again",a.addEventListener("click",()=>{s.remove(),F()}),l.appendChild(t),l.appendChild(n),l.appendChild(a),s.appendChild(l),document.body.appendChild(s),setTimeout(()=>{s.classList.add("show")},10)}window.addEventListener("load",()=>{setTimeout(()=>{d.children.length===0&&e.cardsInPlay.length>0&&(console.log("Window loaded: Forcing re-render of cards"),u(),E())},500)})});document.addEventListener("DOMContentLoaded",()=>{const e={deck:[],cardsInPlay:[],selectedCards:[],setsFound:0,gameOver:!1,introShown:!1,gameStarted:!1,hintDisabled:!1},b=["red","green","purple"],$=["oval","triangle","rectangle"],B=[1,2,3],r=["solid","striped","open"],d=document.getElementById("game-board"),L=document.getElementById("score"),j=document.getElementById("remaining"),p=document.getElementById("deal-cards"),S=document.getElementById("find-set"),R=document.getElementById("restart"),U=document.getElementById("show-help"),c=document.getElementById("intro-overlay"),W=document.getElementById("start-game"),Y=document.getElementById("dont-show-again"),V=document.getElementById("help-button"),k=document.getElementById("interstitial-ad-overlay"),O=document.getElementById("countdown-timer"),N=document.getElementById("close-ad");let f=null,h=10,i=null;q(),p.addEventListener("click",()=>y(()=>J())),S.addEventListener("click",()=>y(()=>H())),R.addEventListener("click",()=>y(()=>_())),U.addEventListener("click",()=>y(()=>v())),W.addEventListener("click",M),V.addEventListener("click",v);function y(t){k.style.display!=="flex"&&(i=t,h=10,k.style.display="flex",A())}function A(){D(),f=setInterval(()=>{h--,D(),h<=0&&(clearInterval(f),P(!1))},1e3)}function D(){O&&(O.textContent=h)}function P(t=!1){f&&(clearInterval(f),f=null),k.style.display="none",t&&i&&i.toString().includes("findSet")?(e.hintDisabled=!0,w("广告被提前关闭，Hint功能已禁用。","warning"),S.classList.add("disabled"),S.disabled=!0):i&&i(),i=null}N&&N.addEventListener("click",()=>{P(!0)});function q(){localStorage.getItem("set_game_played")?(M(!0),x()):(x(),v())}function v(){c.classList.remove("hidden"),e.introShown=!0}function M(t){Y.checked&&localStorage.setItem("set_game_played","true"),e.cardsInPlay.length>0&&m(),t?(c.classList.add("hidden"),e.gameStarted||(e.cardsInPlay.length===0?x():(m(),C()))):(c.style.opacity="1",c.style.transition="opacity 0.5s ease",setTimeout(()=>{c.style.opacity="0",setTimeout(()=>{c.classList.add("hidden"),c.style.opacity="",c.style.transition="",e.cardsInPlay.length===0?x():(m(),C())},500)},10)),e.introShown=!0}function x(){e.gameOver=!1,e.cardsInPlay=[],K(),z(),u(),d.children.length===0&&e.cardsInPlay.length>0&&(console.log("Forcing re-render of cards"),m()),C(),e.gameStarted=!0}function K(){e.deck=[];for(const t of b)for(const n of $)for(const a of B)for(const o of r)e.deck.push({color:t,shape:n,number:a,shading:o})}function z(){for(let t=e.deck.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e.deck[t],e.deck[n]]=[e.deck[n],e.deck[t]]}}function u(){e.cardsInPlay=[];for(let t=0;t<12;t++)e.deck.length>0&&e.cardsInPlay.push(e.deck.pop());m()}function J(){if(e.gameOver)return;if(T()){w("There is still a set on the board. Find it first!"),s();return}const t=[];for(let n=0;n<3;n++)if(e.deck.length>0){const a=e.deck.pop();e.cardsInPlay.push(a),t.push(e.cardsInPlay.length-1)}m(),t.length>0&&setTimeout(()=>{t.forEach(n=>{const a=document.querySelector(`.card[data-index="${n}"]`);a&&(a.classList.add("new-card"),setTimeout(()=>a.classList.remove("new-card"),1e3))})},100),C()}function m(){d.innerHTML="",e.cardsInPlay.forEach((t,n)=>{const a=document.createElement("div");a.className="card",a.dataset.index=n,e.selectedCards.includes(n)&&a.classList.add("selected");const g=Q(t);a.appendChild(g),a.addEventListener("click",()=>G(n)),d.appendChild(a)}),d.offsetHeight}function Q(t){const n=document.createElement("div");n.className="card-content";for(let a=0;a<t.number;a++){const o=document.createElement("div");o.className=`symbol ${t.shape} ${t.shading}`,o.style.color=t.color;let g="";t.shape==="triangle"?(o.style.color=t.color,o.style.opacity="",o.style.background="",o.style.borderBottomColor=""):t.shape==="rectangle"?t.shading==="open"?(o.style.background="transparent",o.style.border=`2px solid ${t.color}`):t.shading==="striped"?(o.style.background=`repeating-linear-gradient(45deg, ${t.color}, ${t.color} 3px, transparent 3px, transparent 6px)`,o.style.border=`1px solid ${t.color}`):o.style.background=t.color:t.shape==="oval"&&(t.shading==="open"?(o.style.background="transparent",o.style.border=`2px solid ${t.color}`):t.shading==="striped"?(o.style.background=`repeating-linear-gradient(45deg, ${t.color}, ${t.color} 3px, transparent 3px, transparent 6px)`,o.style.border=`1px solid ${t.color}`):o.style.background=t.color),o.textContent=g,t.shape==="triangle"||(t.shape==="rectangle"?(o.style.width="60%",o.style.height=t.number>2?"20px":"25px"):t.shape==="oval"&&(o.style.width="60%",o.style.height=t.number>2?"20px":"25px",o.style.borderRadius="50%"));const I=document.createElement("div");I.className=`symbol-wrapper ${t.shape}-wrapper`,I.style.display="flex",I.style.alignItems="center",I.style.justifyContent="center",I.style.padding="5px",I.style.width="100%",I.style.height=(t.number>2,"33%"),I.appendChild(o),n.appendChild(I)}return n}function G(t){if(e.gameOver)return;const n=document.querySelector(`.card[data-index="${t}"]`),a=e.selectedCards.indexOf(t);a!==-1?(e.selectedCards.splice(a,1),n.classList.remove("selected")):(e.selectedCards.push(t),n.classList.add("selected"),e.selectedCards.length===3&&X())}function X(){const t=e.selectedCards.map(a=>e.cardsInPlay[a]),n=e.selectedCards.map(a=>document.querySelector(`.card[data-index="${a}"]`));E(t)?(n.forEach(a=>{a.classList.add("correct-set")}),setTimeout(()=>{Z()},800)):(n.forEach(a=>{a.classList.add("incorrect-set")}),setTimeout(()=>{n.forEach(a=>{a.classList.remove("incorrect-set"),a.classList.remove("selected")}),e.selectedCards=[]},1e3))}function E(t){const n=a=>{const o=t.map(g=>g[a]);return o[0]===o[1]&&o[1]===o[2]||o[0]!==o[1]&&o[1]!==o[2]&&o[0]!==o[2]};return n("color")&&n("shape")&&n("number")&&n("shading")}function Z(){e.setsFound++;const t=[...e.selectedCards].sort((n,a)=>a-n);for(const n of t)e.deck.length>0?e.cardsInPlay[n]=e.deck.pop():e.cardsInPlay.splice(n,1);e.selectedCards=[],m(),C(),w(`Set found! You've found ${e.setsFound} sets so far.`,"success"),e.deck.length===0&&!T()&&(e.gameOver=!0,setTimeout(()=>{l()},500))}function C(){L.textContent=e.setsFound,j.textContent=e.deck.length,p.disabled=e.deck.length===0,e.deck.length===0?p.classList.add("disabled"):p.classList.remove("disabled")}function H(){if(e.gameOver)return;if(e.hintDisabled){w("Hint功能已被禁用。","warning");return}const t=F();t?(e.selectedCards=t,m(),t.forEach(n=>{document.querySelector(`.card[data-index="${n}"]`).classList.add("hint-pulse")}),setTimeout(()=>{t.forEach(n=>{document.querySelector(`.card[data-index="${n}"]`).classList.remove("hint-pulse")}),e.selectedCards=[],m()},2e3)):w("No sets found on the board. Deal more cards.")}function F(){const t=e.cardsInPlay.length;for(let n=0;n<t-2;n++)for(let a=n+1;a<t-1;a++)for(let o=a+1;o<t;o++){const g=[e.cardsInPlay[n],e.cardsInPlay[a],e.cardsInPlay[o]];if(E(g))return[n,a,o]}return null}function T(){return F()!==null}function _(){e.deck=[],e.cardsInPlay=[],e.selectedCards=[],e.setsFound=0,e.gameOver=!1,d.innerHTML="",d.classList.add("restart-animation"),setTimeout(()=>{d.classList.remove("restart-animation"),x()},500)}function w(t,n="warning"){const a=document.querySelector(".notification");a&&a.remove();const o=document.createElement("div");o.className=`notification ${n}`,o.textContent=t,document.body.appendChild(o),setTimeout(()=>o.classList.add("show"),10),setTimeout(()=>{o.classList.remove("show"),setTimeout(()=>o.remove(),300)},3e3)}function s(){d.classList.add("highlight"),setTimeout(()=>{d.classList.remove("highlight")},1e3)}function l(){const t=document.createElement("div");t.className="game-over-modal";const n=document.createElement("div");n.className="modal-content";const a=document.createElement("h2");a.textContent="Game Over!";const o=document.createElement("p");o.textContent=`Congratulations! You found ${e.setsFound} sets.`;const g=document.createElement("button");g.textContent="Play Again",g.addEventListener("click",()=>{t.remove(),_()}),n.appendChild(a),n.appendChild(o),n.appendChild(g),t.appendChild(n),document.body.appendChild(t),setTimeout(()=>{t.classList.add("show")},10)}window.addEventListener("load",()=>{setTimeout(()=>{d.children.length===0&&e.cardsInPlay.length>0&&(console.log("Window loaded: Forcing re-render of cards"),m(),C())},500)})});</script>
    <style rel="stylesheet" crossorigin>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background-color:#e9f5f5;padding:20px;min-height:100vh}.container{max-width:1000px;margin:0 auto;background-color:#fff;padding:20px;border-radius:15px;box-shadow:0 5px 15px #0000001a;position:relative;z-index:1}header{text-align:center;margin-bottom:20px}h1{color:#2c3e50;font-size:2.2rem;margin-bottom:5px}.game-info{display:flex;justify-content:space-between;margin-bottom:20px;padding:12px 15px;background-color:#f1f8f8;border-radius:8px;box-shadow:0 2px 4px #0000000d}.stats{display:flex;gap:15px;font-weight:500}.controls button{padding:8px 15px;margin-left:10px;background-color:#3498db;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:all .2s ease;font-weight:500}.controls button:hover{background-color:#2980b9;transform:translateY(-2px)}.controls button#restart{background-color:#e74c3c}.controls button#restart:hover{background-color:#c0392b}.controls button#find-set{background-color:#f39c12}.controls button#find-set:hover{background-color:#d35400}.game-board{display:grid;grid-template-columns:repeat(6,1fr);gap:12px;margin-bottom:30px;padding:5px}.card{aspect-ratio:2/3;background-color:#fff;border-radius:8px;box-shadow:0 3px 6px #0000001a;padding:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;position:relative;border:1px solid #e0e0e0;min-height:100px}.card:hover{transform:translateY(-3px);box-shadow:0 5px 10px #00000026}.card.selected{box-shadow:0 0 0 3px #4caf50,0 5px 10px #0000001a;transform:translateY(-3px) scale(1.03)}.card.correct-set{box-shadow:0 0 15px #4caf50;animation:correct-pulse .8s ease}.card.incorrect-set{box-shadow:0 0 15px #e74c3c;animation:incorrect-pulse .8s ease}.card.hint-pulse{animation:hint-pulse 2s ease}.card.new-card{animation:new-card-highlight 1s ease}.card-content{display:flex;flex-direction:column;align-items:center;justify-content:space-around;height:100%;width:100%}.symbol-wrapper{display:flex;align-items:center;justify-content:center;margin:5px 0;height:30px}.symbol{text-align:center;margin:3px 0;transition:transform .2s ease;display:block!important;font-size:0!important}.symbol.triangle{position:relative;width:0!important;height:0!important;border-left:15px solid transparent!important;border-right:15px solid transparent!important;border-bottom:25px solid currentColor!important;background-color:transparent!important;display:block!important;margin:0 auto;min-width:30px;min-height:20px}.symbol.triangle.open{position:relative;width:30px!important;height:25px!important;background-color:transparent!important;border:none!important;margin:0 auto}.symbol.triangle.open:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:currentColor;clip-path:polygon(50% 0%,0% 100%,100% 100%);z-index:1}.symbol.triangle.open:after{content:"";position:absolute;top:2px;left:2px;width:calc(100% - 4px);height:calc(100% - 4px);background-color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);z-index:2}.symbol.triangle.striped{position:relative;width:0!important;height:0!important;border-left:15px solid transparent!important;border-right:15px solid transparent!important;border-bottom:25px solid transparent!important;background-color:transparent!important;display:block!important;margin:0 auto;min-width:30px;min-height:20px}.symbol.triangle.striped:before{content:"";position:absolute;width:30px;height:26px;top:0;left:-15px;clip-path:polygon(50% 0%,0% 100%,100% 100%);background-image:repeating-linear-gradient(45deg,currentColor,currentColor 3px,transparent 3px,transparent 6px);z-index:1}.symbol.triangle.striped:after{content:"";position:absolute;width:30px;height:26px;top:0;left:-15px;clip-path:polygon(50% 0%,0% 100%,100% 100%);box-shadow:0 0 0 1px currentColor;background-color:transparent;z-index:2}.symbol.triangle.solid{border-bottom-color:currentColor!important}.symbol.rectangle{border-radius:0!important;display:block!important;margin:0 auto;min-height:20px;min-width:30px}.symbol.rectangle.open{background-color:transparent!important;border:2px solid currentColor!important}.symbol.rectangle.striped{background:repeating-linear-gradient(45deg,currentColor,currentColor 3px,transparent 3px,transparent 6px)!important;border:1px solid currentColor!important}.symbol.rectangle.solid{background-color:currentColor!important}.symbol.oval{border-radius:50%!important;display:block!important;margin:0 auto;min-height:20px;min-width:30px}.symbol.oval.open{background-color:transparent!important;border:2px solid currentColor!important}.symbol.oval.striped{background:repeating-linear-gradient(45deg,currentColor,currentColor 3px,transparent 3px,transparent 6px)!important;border:1px solid currentColor!important}.symbol.oval.solid{background-color:currentColor!important}.card:hover .symbol{transform:scale(1.1)}.rules{background-color:#f9f9f9;padding:15px;border-radius:8px;margin-top:20px;box-shadow:0 2px 4px #0000000d}.rules h2{margin-bottom:10px;color:#2c3e50;font-size:1.4rem}.rules p{margin-bottom:10px;line-height:1.5;color:#34495e}@media (min-width: 769px){.game-board{grid-template-columns:repeat(6,1fr)}}@media (max-width: 768px){.game-board{grid-template-columns:repeat(4,1fr)}.game-info{flex-direction:column;gap:10px}.controls{display:flex;justify-content:center;flex-wrap:wrap;gap:10px}.controls button{margin:0;flex:1;min-width:80px}.stats{justify-content:center}}@media (max-width: 600px){.game-board{grid-template-columns:repeat(6,1fr)!important;grid-auto-rows:auto;gap:5px;max-height:none;overflow-y:visible}.card{min-height:40px!important;padding:2px;aspect-ratio:2/3;min-width:0;width:100%}.symbol{font-size:.7rem!important}.symbol-wrapper{margin:1px 0;height:14px}.card:nth-child(n+13){display:flex}.symbol.rectangle,.symbol.oval{width:45%!important;height:10px!important}.symbol.triangle{border-left:8px solid transparent!important;border-right:8px solid transparent!important;border-bottom:14px solid currentColor!important;min-width:16px;min-height:12px}}@media (max-width: 480px){.game-board{grid-template-columns:repeat(6,1fr)!important;gap:3px}h1{font-size:1.4rem}.card{padding:1px;min-height:35px!important;border-radius:4px}.stats{flex-direction:column;gap:5px;align-items:center}.symbol.rectangle,.symbol.oval{width:40%!important;height:8px!important}.symbol.triangle{border-left:6px solid transparent!important;border-right:6px solid transparent!important;border-bottom:10px solid currentColor!important;min-width:12px;min-height:8px}.symbol-wrapper{height:12px;margin:0}}@media (max-width: 350px){.game-board{grid-template-columns:repeat(6,1fr)!important;gap:2px}.card{min-height:30px!important;padding:1px;border-width:1px}.symbol-wrapper{height:10px}.symbol{font-size:.6rem!important}.symbol.rectangle,.symbol.oval{width:35%!important;height:6px!important}.symbol.triangle{border-left:4px solid transparent!important;border-right:4px solid transparent!important;border-bottom:8px solid currentColor!important;min-width:8px;min-height:6px}}@keyframes correct-pulse{0%,to{transform:translateY(-3px) scale(1)}50%{transform:translateY(-3px) scale(1.08);background-color:#4caf501a}}@keyframes incorrect-pulse{0%,to{transform:translateY(0) scale(1)}50%{transform:translateY(0) scale(1.05);background-color:#e74c3c1a}}@keyframes hint-pulse{0%,to{box-shadow:0 0 #f39c1266}50%{box-shadow:0 0 20px #f39c12cc}}@keyframes new-card-highlight{0%{transform:translateY(-10px);opacity:0}to{transform:translateY(0);opacity:1}}.game-board.highlight{animation:board-highlight 1s ease}.game-board.restart-animation{animation:restart .5s ease}@keyframes board-highlight{0%,to{background-color:transparent}50%{background-color:#3498db1a}}@keyframes restart{0%{opacity:1;transform:scale(1)}50%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.notification{position:fixed;top:20px;right:20px;padding:12px 20px;background-color:#f8f9fa;border-left:4px solid #6c757d;border-radius:4px;box-shadow:0 4px 12px #0000001a;z-index:1000;transform:translate(120%);transition:transform .3s ease;max-width:350px}.notification.show{transform:translate(0)}.notification.success{background-color:#d4edda;border-color:#4caf50;color:#155724}.notification.warning{background-color:#fff3cd;border-color:#f39c12;color:#856404}.game-over-modal{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:2000;opacity:0;transition:opacity .3s ease}.game-over-modal.show{opacity:1}.modal-content{background-color:#fff;padding:30px;border-radius:10px;box-shadow:0 10px 25px #0003;text-align:center;transform:scale(.9);transition:transform .3s ease;max-width:400px;width:90%}.game-over-modal.show .modal-content{transform:scale(1)}.modal-content h2{color:#2c3e50;margin-bottom:15px}.modal-content p{color:#34495e;margin-bottom:20px}.modal-content button{padding:10px 25px;background-color:#3498db;color:#fff;border:none;border-radius:5px;cursor:pointer;font-weight:500;transition:background-color .2s}.modal-content button:hover{background-color:#2980b9}.controls button.disabled{background-color:#ccc;cursor:not-allowed}.controls button.disabled:hover{background-color:#ccc;transform:none}.intro-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000c;z-index:3000;display:flex;justify-content:center;align-items:center;overflow-y:auto}.intro-overlay.hidden{display:none;z-index:-1;pointer-events:none}.intro-content{background-color:#fff;border-radius:15px;box-shadow:0 10px 30px #0000004d;padding:30px;max-width:800px;width:90%;max-height:90vh;overflow-y:auto;position:relative}.intro-content h2{color:#2c3e50;text-align:center;font-size:2rem;margin-bottom:20px;border-bottom:2px solid #e9f5f5;padding-bottom:15px}.intro-section{margin-bottom:30px}.intro-section h3{color:#3498db;margin-bottom:15px;font-size:1.4rem}.intro-examples{display:flex;flex-direction:column;gap:25px;margin-top:20px}.example{background-color:#f9f9f9;border-radius:10px;padding:15px;box-shadow:0 2px 5px #0000000d}.example h4{margin-bottom:15px;color:#2c3e50;font-size:1.1rem}.example-cards{display:flex;justify-content:center;gap:15px;margin-bottom:15px}.example-card{width:80px;height:120px;background-color:#fff;border-radius:8px;box-shadow:0 2px 5px #0000001a;display:flex;align-items:center;justify-content:center;border:1px solid #e0e0e0}.example-symbol{font-size:0;text-align:center}.example-symbol.red{color:red}.example-symbol.green{color:green}.example-symbol.purple{color:purple}.example-symbol.oval{border-radius:50%!important;display:block!important;margin:0 auto;width:30px!important;height:20px!important;background-color:currentColor;font-size:0!important;text-indent:-9999px;overflow:hidden}.example-symbol.oval.open{background-color:transparent!important;border:2px solid currentColor!important}.example-symbol.oval.striped{background:repeating-linear-gradient(45deg,currentColor,currentColor 3px,transparent 3px,transparent 6px)!important;border:1px solid currentColor!important}.example-symbol.oval.solid{background-color:currentColor!important}.example-symbol.diamond{transform:rotate(45deg)}.example-symbol.solid{opacity:1}.example-symbol.striped{opacity:.6}.example-symbol.open{opacity:.3;border:2px solid;background:transparent;color:transparent}.example-symbol.rectangle{border-radius:0!important;display:block!important;margin:0 auto;width:30px!important;height:20px!important;background-color:currentColor;font-size:0!important;text-indent:-9999px;overflow:hidden}.example-symbol.rectangle.open{background-color:transparent!important;border:2px solid currentColor!important}.example-symbol.rectangle.striped{background:repeating-linear-gradient(45deg,currentColor,currentColor 3px,transparent 3px,transparent 6px)!important;border:1px solid currentColor!important}.example-symbol.rectangle.solid{background-color:currentColor!important}.example-symbol.triangle{position:relative;width:0!important;height:0!important;border-left:15px solid transparent!important;border-right:15px solid transparent!important;border-bottom:25px solid currentColor!important;background-color:transparent!important;display:block!important;margin:0 auto;font-size:0!important;text-indent:-9999px;overflow:hidden}.example-symbol.triangle.open{position:relative;width:30px!important;height:25px!important;background-color:transparent!important;border:none!important;margin:0 auto}.example-symbol.triangle.open:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:currentColor;clip-path:polygon(50% 0%,0% 100%,100% 100%);z-index:1}.example-symbol.triangle.open:after{content:"";position:absolute;top:2px;left:2px;width:calc(100% - 4px);height:calc(100% - 4px);background-color:#fff;clip-path:polygon(50% 0%,0% 100%,100% 100%);z-index:2}.example-symbol.triangle.striped{position:relative;width:0!important;height:0!important;border-left:15px solid transparent!important;border-right:15px solid transparent!important;border-bottom:25px solid transparent!important;background-color:transparent!important;display:block!important;margin:0 auto}.example-symbol.triangle.striped:before{content:"";position:absolute;width:30px;height:26px;top:0;left:-15px;clip-path:polygon(50% 0%,0% 100%,100% 100%);background-image:repeating-linear-gradient(45deg,currentColor,currentColor 3px,transparent 3px,transparent 6px);z-index:1}.example-symbol.triangle.striped:after{content:"";position:absolute;width:30px;height:26px;top:0;left:-15px;clip-path:polygon(50% 0%,0% 100%,100% 100%);box-shadow:0 0 0 1px currentColor;background-color:transparent;z-index:2}.example-symbol.triangle.solid{border-bottom-color:currentColor!important}.features-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-top:20px}.feature{background-color:#f9f9f9;border-radius:8px;padding:15px;box-shadow:0 2px 5px #0000000d}.feature h4{margin-bottom:10px;color:#2c3e50}.feature-examples{display:flex;flex-direction:column;gap:8px}.feature-item{padding:5px 10px;border-radius:4px;background-color:#fff;box-shadow:0 1px 3px #0000001a}.feature-item.red{color:red}.feature-item.green{color:green}.feature-item.purple{color:purple}.solid-example{background-color:#3498db;color:#fff}.striped-example{background:repeating-linear-gradient(45deg,#3498db,#3498db 3px,#fff 3px,#fff 6px);color:transparent;border:1px solid #3498db}.open-example{border:2px solid #3498db;color:#3498db;background-color:transparent}.intro-controls{display:flex;justify-content:space-between;align-items:center;margin-top:30px}.show-intro-checkbox{display:flex;align-items:center;gap:5px;font-size:.9rem;color:#7f8c8d}.start-button{padding:12px 25px;background-color:#3498db;color:#fff;border:none;border-radius:6px;font-weight:600;font-size:1.1rem;cursor:pointer;transition:all .2s ease}.start-button:hover{background-color:#2980b9;transform:translateY(-2px)}.help-button{position:absolute;top:15px;right:15px;width:30px;height:30px;border-radius:50%;background-color:#3498db;color:#fff;border:none;font-size:16px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center}.help-btn{background-color:#9b59b6!important}.help-btn:hover{background-color:#8e44ad!important}@media (max-width: 600px){.intro-content{padding:20px}.example-cards{flex-direction:column;align-items:center}.features-grid{grid-template-columns:1fr}.intro-controls{flex-direction:column;gap:15px}.start-button{width:100%}}.ad-container{margin:20px auto;text-align:center;overflow:hidden;background-color:#f9f9f9;border-radius:8px;padding:0;width:320px;height:50px;display:flex;align-items:center;justify-content:center}.close-ad-btn{position:absolute;top:5px;right:5px;width:25px;height:25px;background-color:#00000080;color:#fff;border:none;border-radius:50%;font-size:18px;line-height:1;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:5001;transition:background-color .2s ease}.close-ad-btn:hover{background-color:#000c}.ad-banner{width:320px;height:50px}.main-content-wrapper{display:flex;flex-direction:column;gap:20px;margin-bottom:30px;align-items:center}.game-board{display:grid;grid-template-columns:repeat(6,1fr);gap:12px;width:100%;padding:5px}.ad-sidebar,.ad-in-feed{width:320px;height:50px}@media (max-width: 768px){.main-content-wrapper{flex-direction:column;align-items:center}.ad-container{margin:15px auto}}</style>
  </head>
  <body>
    <!-- 插屏广告覆盖层 -->
    <div id="interstitial-ad-overlay" class="interstitial-ad-overlay">
      <div class="interstitial-ad-container">
        <div class="countdown-timer" id="countdown-timer">
          广告将在 10 秒后关闭
        </div>
        <button id="close-ad" class="close-ad-btn">×</button>
        <ins
          class="adsbygoogle"
          style="display: inline-block; width: 300px; height: 250px"
          data-ad-client="ca-pub-3424102604992913"
          data-ad-slot="2199356140"
        ></ins>
      </div>
    </div>

    <div id="intro-overlay" class="intro-overlay">
      <div class="intro-content">
        <h2>Welcome to Set!</h2>
        <div class="intro-section">
          <h3>How to Play</h3>
          <p>
            The goal is to find "sets" of three cards where each feature is
            either all the same or all different across the cards.
          </p>

          <div class="intro-examples">
            <div class="example">
              <h4>This is a SET ✓</h4>
              <div class="example-cards">
                <div class="example-card">
                  <div class="example-symbol red oval solid"></div>
                </div>
                <div class="example-card">
                  <div class="example-symbol green oval solid"></div>
                </div>
                <div class="example-card">
                  <div class="example-symbol purple oval solid"></div>
                </div>
              </div>
              <p>
                Colors are all <strong>different</strong>, shapes are all the
                <strong>same</strong>, numbers are all the
                <strong>same</strong>, shadings are all the
                <strong>same</strong>.
              </p>
            </div>

            <div class="example">
              <h4>This is NOT a SET ✗</h4>
              <div class="example-cards">
                <div class="example-card">
                  <div class="example-symbol red triangle solid"></div>
                </div>
                <div class="example-card">
                  <div class="example-symbol red oval solid"></div>
                </div>
                <div class="example-card">
                  <div class="example-symbol green triangle solid"></div>
                </div>
              </div>
              <p>
                Colors are not all the same or all different. Shapes are not all
                the same or all different.
              </p>
            </div>
          </div>
        </div>

        <div class="intro-section">
          <h3>Card Features</h3>
          <div class="features-grid">
            <div class="feature">
              <h4>Colors</h4>
              <div class="feature-examples">
                <span class="feature-item red">Red</span>
                <span class="feature-item green">Green</span>
                <span class="feature-item purple">Purple</span>
              </div>
            </div>
            <div class="feature">
              <h4>Shapes</h4>
              <div class="feature-examples">
                <span class="feature-item"
                  ><div
                    style="
                      display: inline-block;
                      width: 15px;
                      height: 15px;
                      background: currentColor;
                      border-radius: 50%;
                      margin-right: 5px;
                      vertical-align: middle;
                    "
                  ></div>
                  Oval</span
                >
                <span class="feature-item">▲&nbsp;Triangle</span>
                <span class="feature-item"
                  ><div
                    style="
                      display: inline-block;
                      width: 15px;
                      height: 15px;
                      background: currentColor;
                      margin-right: 5px;
                      vertical-align: middle;
                    "
                  ></div>
                  Rectangle</span
                >
              </div>
            </div>
            <div class="feature">
              <h4>Number</h4>
              <div class="feature-examples">
                <span class="feature-item">1 symbol</span>
                <span class="feature-item">2 symbols</span>
                <span class="feature-item">3 symbols</span>
              </div>
            </div>
            <div class="feature">
              <h4>Shading</h4>
              <div class="feature-examples">
                <span class="feature-item solid-example">Solid</span>
                <span class="feature-item striped-example">Striped</span>
                <span class="feature-item open-example">Open</span>
              </div>
            </div>
          </div>
        </div>

        <div class="intro-controls">
          <label class="show-intro-checkbox">
            <input type="checkbox" id="dont-show-again" /> Don't show this again
          </label>
          <button id="start-game" class="start-button">Start Playing!</button>
        </div>

        <button id="help-button" class="help-button">?</button>
      </div>
    </div>

    <div class="container">
      <header>
        <h1>Set Card Game</h1>
      </header>

      <!-- 横幅广告 -->
      <div class="ad-container ad-banner">
        <ins
          class="adsbygoogle"
          style="display: block; width: 320px; height: 50px"
          data-ad-client="ca-pub-3424102604992913"
          data-ad-slot="2199356140"
          data-ad-format="auto"
          data-full-width-responsive="false"
        ></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>

      <div class="game-info">
        <div class="stats">
          <div id="sets-found">Sets Found: <span id="score">0</span></div>
          <div id="cards-remaining">
            Cards Remaining: <span id="remaining">81</span>
          </div>
        </div>
        <div class="controls">
          <button id="deal-cards">Deal Cards</button>
          <button id="find-set">Hint</button>
          <button id="restart">Restart Game</button>
          <button id="show-help" class="help-btn">How to Play</button>
        </div>
      </div>

      <div class="main-content-wrapper">
        <div id="game-board" class="game-board">
          <!-- Cards will be dynamically added here -->
        </div>

        <!-- 侧边栏广告 -->
        <div class="ad-container ad-sidebar">
          <ins
            class="adsbygoogle"
            style="display: block; width: 320px; height: 50px"
            data-ad-client="ca-pub-3424102604992913"
            data-ad-slot="2199356140"
            data-ad-format="auto"
            data-full-width-responsive="false"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </div>

      <div class="rules">
        <h2>How to Play</h2>
        <p>
          Find sets of three cards where for each attribute, the cards either
          all match or all differ.
        </p>
        <p>
          Attributes: Color (red, green, purple), Shape (oval, triangle,
          rectangle), Number (1, 2, 3), Shading (solid, striped, open)
        </p>
      </div>

      <!-- 信息流广告 -->
      <div class="ad-container ad-in-feed">
        <ins
          class="adsbygoogle"
          style="display: block; width: 320px; height: 50px"
          data-ad-client="ca-pub-3424102604992913"
          data-ad-slot="2199356140"
          data-ad-format="auto"
          data-full-width-responsive="false"
        ></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>
    </div>

  </body>
</html>
